# 조사 처리 시스템 테스트 가이드

**작성일시:** 2026-01-13 10:17  
**목적:** JosaHandler가 제대로 작동하는지 확인

---

## ❓ 현재 상태

### 완료된 작업
- ✅ JosaHandler.cs 작성
- ✅ Harmony 패치 구현
- ✅ manifest.json 설정
- ✅ 테스트 퀘스트 파일 생성

### ⏳ 아직 확인 안 됨
- ❌ **실제 게임에서 작동하는지 테스트 필요**
- ❌ 조사가 올바르게 처리되는지 확인 필요

---

## 🧪 테스트 방법

### 방법 1: 게임에서 직접 테스트 (권장)

#### 1단계: 모드 설치
```bash
# 게임 Mods 폴더로 복사
cp -r "/Users/ben/Desktop/무제 폴더/StreamingAssets/Base-Work/Mod/KoreanLocalization" \
   ~/Library/Application\ Support/com.FreeholdGames.CavesOfQud/Mods/
```

#### 2단계: 게임 실행
```
1. Caves of Qud 실행
2. Main Menu → Mods
3. "Korean Localization" 찾기
4. 체크박스 활성화
5. 게임 재시작
```

#### 3단계: 테스트 퀘스트 확인
```
게임 내에서:
1. 새 게임 시작 또는 기존 세이브 로드
2. 퀘스트 로그 열기 (J 키)
3. 테스트 퀘스트 확인
```

#### 예상 결과
```
✅ 성공:
- "조사 테스트 1"
- "검을 발견하라."
- "사과와 책을 찾아라."

❌ 실패:
- "검<josa_eul_reul> 발견하라."  (태그 그대로 표시)
```

---

### 방법 2: 로그 파일 확인

#### 게임 로그 위치
```bash
# Mac
~/Library/Application Support/com.FreeholdGames.CavesOfQud/Player.log
```

#### 확인할 내용
```
성공 시:
[Korean Josa Handler] Harmony patches applied successfully

실패 시:
[Korean Josa Handler] Failed to apply Harmony patches: ...
또는
에러 메시지
```

#### 로그 보기
```bash
tail -f ~/Library/Application\ Support/com.FreeholdGames.CavesOfQud/Player.log
```

---

### 방법 3: 간단한 C# 테스트 (게임 없이)

#### 테스트 프로젝트 생성
```bash
cd ~/Desktop
mkdir JosaTest
cd JosaTest
dotnet new console
```

#### Program.cs
```csharp
using System;

// JosaHandler 코드 복사 (Harmony 부분 제외)
// ... (받침 감지, 조사 선택 함수만)

class Program
{
    static void Main()
    {
        // 테스트
        Console.WriteLine(Choose("검", "을/를"));      // "을"
        Console.WriteLine(Choose("사과", "을/를"));    // "를"
        Console.WriteLine(Choose("서울", "으로/로"));  // "로"
        Console.WriteLine(Choose("집", "으로/로"));    // "으로"
    }
    
    static string Choose(string word, string format)
    {
        // JosaHandler.Choose 로직 복사
        // ...
    }
}
```

---

## 📋 테스트 체크리스트

### 기본 테스트
- [ ] 모드 폴더에 파일 복사 완료
- [ ] 게임 Mods 폴더에 설치 완료
- [ ] 게임에서 모드 활성화 완료
- [ ] 게임 재시작 완료

### 조사 처리 테스트
- [ ] "검을" (을/를, 받침 O)
- [ ] "사과를" (을/를, 받침 X)
- [ ] "책이" (이/가, 받침 O)
- [ ] "연필이" (이/가, 받침 X)
- [ ] "서울로" (으로/로, ㄹ 받침)
- [ ] "집으로" (으로/로, 다른 받침)

### 로그 확인
- [ ] Player.log 파일 확인
- [ ] Harmony 패치 성공 메시지 확인
- [ ] 에러 메시지 없음 확인

---

## 🚨 예상 문제 및 해결

### 문제 1: 모드가 목록에 안 보임
**원인:** manifest.json 오류

**해결:**
```bash
# manifest.json 문법 확인
cat ~/Library/Application\ Support/com.FreeholdGames.CavesOfQud/Mods/KoreanLocalization/manifest.json
```

### 문제 2: 태그가 그대로 표시됨
**원인:** Harmony 패치 실패

**해결:**
1. Player.log 확인
2. JosaHandler.cs 문법 오류 확인
3. 게임 버전 호환성 확인

### 문제 3: 게임 크래시
**원인:** C# 코드 오류

**해결:**
1. 모드 비활성화
2. JosaHandler.cs 수정
3. 다시 테스트

---

## 📊 테스트 결과 기록

### 테스트 1: 기본 조사
```
날짜: 2026-01-13
입력: "검<josa_eul_reul>"
예상: "검을"
실제: ___________
결과: ☐ 성공 ☐ 실패
```

### 테스트 2: ㄹ 받침
```
입력: "서울<josa_euro_ro>"
예상: "서울로"
실제: ___________
결과: ☐ 성공 ☐ 실패
```

### 테스트 3: 게임 통합
```
대화 텍스트 처리: ☐ 성공 ☐ 실패
퀘스트 텍스트 처리: ☐ 성공 ☐ 실패
메시지 로그 처리: ☐ 성공 ☐ 실패
```

---

## ✅ 성공 기준

### 필수 (Must Have)
- [ ] 모드가 게임에서 로드됨
- [ ] 태그가 조사로 변환됨
- [ ] 받침에 따라 올바른 조사 선택
- [ ] 게임이 크래시하지 않음

### 권장 (Should Have)
- [ ] ㄹ 받침 특수 케이스 작동
- [ ] 모든 조사 타입 작동
- [ ] 성능 문제 없음

---

## 🎯 다음 단계

### 테스트 성공 시
1. 실제 퀘스트 번역 시작
2. Conversations.xml 일부 번역
3. 더 많은 파일 추가

### 테스트 실패 시
1. 로그 분석
2. 코드 수정
3. 재테스트

---

**작성일:** 2026-01-13 10:17  
**상태:** 테스트 준비 완료, 게임 실행 필요
