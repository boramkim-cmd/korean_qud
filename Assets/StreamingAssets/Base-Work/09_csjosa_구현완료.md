# csjosa 방식 구현 완료

**작성일시:** 2026-01-13 10:53  
**상태:** ✅ 구현 완료, 테스트 준비

---

## ✅ 완료된 작업

### 1. JosaHandler.cs 재작성
- ✅ csjosa 알고리즘 구현
- ✅ `Korean.ReplaceJosa()` 함수
- ✅ 괄호 표기법 지원: `단어(조사1)조사2`

### 2. Quests.xml 수정
```xml
<!-- 변경 전 -->
<text>붉은 바위<josa_euro_ro> 가라</text>

<!-- 변경 후 -->
<text>붉은 바위(으)로 가라</text>
```

### 3. 모드 재설치
- ✅ 게임 Mods 폴더에 복사 완료

---

## 🧪 테스트 방법

### 1. 게임 재시작
```
1. Caves of Qud 완전히 종료
2. 재실행
3. Mods 활성화 (이미 되어있음)
4. 새 게임 시작
```

### 2. 퀘스트 확인
```
J 키 → 퀘스트 로그
"워터바인에 무슨 일이?" 확인
```

### 3. 예상 결과

#### ✅ 성공 시
```
"붉은 바위(으)로 가라" → "붉은 바위로 가라"
"워터바인(을)를 먹고" → "워터바인을 먹고"
"시체(을)를 수집" → "시체를 수집"
"조파(으)로 돌아가라" → "조파로 돌아가라"
```

#### ❌ 실패 시
```
괄호가 그대로 표시:
"붉은 바위(으)로 가라"
```

---

## 🔍 디버깅

### 게임 로그 확인
```bash
tail -f ~/Library/Application\ Support/com.FreeholdGames.CavesOfQud/Player.log
```

### 찾아야 할 메시지
```
[Korean Josa] csjosa-based particle system loaded
[Korean Josa] Test: 검이, 사과를, 서울로
```

---

## 📊 작동 원리

### 입력
```xml
<text>검(이)가 좋다</text>
```

### 처리
```
1. 정규표현식 매칭: "검(이)가"
2. 그룹 추출:
   - word = "검"
   - josa1 = "이"
   - josa2 = "가"
3. 받침 확인: HasJongseong("검") = true
4. 조사 선택: josa1 (받침 있음)
5. 결과: "검" + "이" = "검이"
```

### 출력
```
"검이 좋다"
```

---

## 💡 다음 단계

### 성공 시
1. 전체 Quests.xml 번역
2. Conversations.xml 번역
3. HistorySpice.json 번역

### 실패 시
1. 로그 확인
2. Harmony 패치 추가 고려
3. 다른 접근 방식 시도

---

**작성일:** 2026-01-13 10:53  
**다음:** 게임에서 테스트
